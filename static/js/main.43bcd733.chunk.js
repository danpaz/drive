(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{124:function(e,t,n){e.exports=n(213)},129:function(e,t,n){},130:function(e,t,n){},174:function(e,t){},175:function(e,t){},176:function(e,t){},213:function(e,t,n){"use strict";n.r(t);var a=n(11),o=n.n(a),i=n(101),r=n.n(i),l=(n(129),n(102)),s=n(1),u=n(2),c=n(8),d=n(5),h=n(9),g=(n(130),function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){for(var e=this.props,t=e.routeResult,n=e.distanceAlongGeometry,a=e.currentRouteStepIndex,i=t.legs[0].steps[a],r=i.distance-n,l=i.bannerInstructions[0],s=0;s<i.bannerInstructions.length;s++)i.bannerInstructions[s].distanceAlongGeometry>r&&(l=i.bannerInstructions[s]);return o.a.createElement("div",{className:"banner"},o.a.createElement("div",{className:"primary"},l.primary.text),o.a.createElement("div",{className:"secondary"},l.secondary&&l.secondary.text))}}]),t}(a.Component));var m=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e,t,n=this.props,a=n.routeResult,i=n.onClickStartNavigation,r=n.onClickStartSimulation,l=n.onClickCancelNavigation,s=n.isNavigating,u=(e=a.duration,{value:Math.round(e/60),unit:"min"}),c=(t=a.distance,{value:Math.round(t/1e3),unit:"km"});return o.a.createElement("div",null,s?o.a.createElement("button",{onClick:l},"Cancel"):o.a.createElement("div",null,o.a.createElement("div",null,u.value," ",u.unit," (",c.value," ",c.unit,")"),o.a.createElement("div",null,o.a.createElement("button",{onClick:i},"Start"),o.a.createElement("button",{onClick:r},"Simulate"))))}}]),t}(a.Component),p=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.searchResult,n=e.onClick;return o.a.createElement("div",null,o.a.createElement("div",null,t.text),o.a.createElement("div",null,t.properties.address),o.a.createElement("button",{onClick:n},"Directions"))}}]),t}(a.Component),v=n(80),f=n(104),y=n.n(f),w=n(60),R=(n(187),n(67)),b=n.n(R),C=n(108),S=n.n(C),k=n(109),j=n.n(k),N=n(39),I=n(81),P=n.n(I),E=n(110),L=n.n(E),O=n(211),x=S()({accessToken:"pk.eyJ1IjoiZGFucGF6IiwiYSI6ImNqMjVpYmk5czAwN2sycXBjYmd0eGNrdjkifQ.WLg6LD184VYKYQPbW7NY7w"}),W=j()(x);function G(e,t,n){var a=t/1e3/1e3,o=0;return setInterval(function(){o<1e3&&function(){o+=1;var t=L()(e,o*a,{units:"kilometers"});n({coords:{longitude:t.geometry.coordinates[0],latitude:t.geometry.coordinates[1]},timestamp:Date.now()})}()},100)}function A(){return new Promise(function(e,t){navigator.geolocation.getCurrentPosition(e,t)})}var V=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={viewport:{width:window.innerWidth,height:window.innerHeight-200,latitude:40,longitude:-90,zoom:2,maxZoom:18,transitionDuration:1e3},geolocationWatcher:null,currentPosition:{latitude:null,longitude:null,lastupdated:null},currentPositionLayer:null,currentRouteStepIndex:0,searchResult:null,searchResultLayer:null,routeResult:null,routeResultLayer:null,isNavigating:!1,simulationIntervalId:null},n.mapRef=o.a.createRef(),n.handleViewportChange=function(e){n.setState({viewport:Object(l.a)({},n.state.viewport,e)})},n.handleSearchResult=function(e){n.setState({routeResult:null,routeResultLayer:null,searchResult:e.result,searchResultLayer:new w.a({id:"search-result",data:e.result.geometry,getFillColor:[253,153,108,255],getLineColor:[255,255,255,255],getRadius:7,pointRadiusMinPixels:7,getLineWidth:2,lineWidthMinPixels:2,stroked:!0,filled:!0})})},n.handleSearchClear=function(e){n.setState({searchResult:null,searchResultLayer:null,routeResult:null,routeResultLayer:null})},n.handlePositionChange=function(e){n.setState({currentPosition:{longitude:e.coords.longitude,latitude:e.coords.latitude,lastupdated:e.timestamp},currentPositionLayer:new w.a({id:"current-position",data:{type:"Point",coordinates:[e.coords.longitude,e.coords.latitude]},getFillColor:[70,136,241,255],getLineColor:[255,255,255,255],getRadius:7,pointRadiusMinPixels:7,getLineWidth:2,lineWidthMinPixels:2,stroked:!0,filled:!0})})},n.handleGetDirections=function(e){A().then(function(e){return n.handlePositionChange(e)}).then(function(){return function(e,t){var n={profile:"driving-traffic",geometries:"geojson",overview:"full",steps:!0,bannerInstructions:!0,waypoints:[{coordinates:e},{coordinates:t}]};return W.getDirections(n).send().then(function(e){return e.body.routes})}([n.state.currentPosition.longitude,n.state.currentPosition.latitude],n.state.searchResult.center)}).then(function(e){return n.setState({routeResult:e[0],routeResultLayer:new w.a({id:"route-result",data:e[0].geometry,lineWidthMinPixels:3,getLineColor:[66,100,251,200],getLineWidth:7})})}).then(function(){var e=n.state.routeResult.geometry.coordinates,t=e.reduce(function(e,t){return e.extend(t)},new b.a.LngLatBounds(e[0],e[0])),a=O.viewport([t.getWest(),t.getSouth(),t.getEast(),t.getNorth()],[400,400]);n.handleViewportChange({longitude:a.center[0],latitude:a.center[1],zoom:a.zoom})}).catch(function(e){return console.error(e)})},n.handleNewPositionSuccess=function(e){var t,a=n.state.currentRouteStepIndex||0,o=n.state.routeResult.legs[0].steps[a],i=n.state.routeResult.legs[0].steps[a+1],r=P()(o.geometry,N.point([e.coords.longitude,e.coords.latitude])),l=P()(i.geometry,N.point([e.coords.longitude,e.coords.latitude]));l.properties.dist<r.properties.dist&&l.properties.location<.05?(t=l,a+=1):t=r;var s=1e3*t.properties.location;n.handlePositionChange(e),n.handleViewportChange({longitude:e.coords.longitude,latitude:e.coords.latitude,zoom:16}),n.setState({currentRouteStepIndex:a,distanceAlongGeometry:s})},n.handleNewPositionError=function(e){console.error(e)},n.handleStartNavigation=function(){var e,t,a=(e=n.handleNewPositionSuccess,t=n.handleNewPositionError,navigator.geolocation.watchPosition(e,t,{enableHighAccuracy:!0,maximumAge:5e3}));n.setState({isNavigating:!0,geolocationWatcher:a})},n.handleStartSimulation=function(){var e=n.state.routeResult,t=G(e.geometry,e.distance,n.handleNewPositionSuccess);n.setState({isNavigating:!0,simulationIntervalId:t})},n.handleCancelNavigation=function(){clearInterval(n.state.simulationIntervalId),n.setState({isNavigating:!1,simulationIntervalId:null})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;A().then(function(t){e.handlePositionChange(t),e.handleViewportChange({longitude:t.coords.longitude,latitude:t.coords.latitude,zoom:16})})}},{key:"render",value:function(){var e,t=this.state,n=t.viewport,a=t.searchResult,i=t.searchResultLayer,r=t.routeResult,l=t.routeResultLayer,s=t.currentPosition,u=t.currentPositionLayer,c=t.currentRouteStepIndex,d=t.distanceAlongGeometry,h=t.isNavigating;return a&&!r?e=o.a.createElement(p,{searchResult:a,onClick:this.handleGetDirections}):r&&(e=o.a.createElement(m,{routeResult:r,isNavigating:h,onClickStartNavigation:this.handleStartNavigation,onClickStartSimulation:this.handleStartSimulation,onClickCancelNavigation:this.handleCancelNavigation})),o.a.createElement(o.a.Fragment,null,h&&r&&o.a.createElement(g,{routeResult:r,distanceAlongGeometry:d,currentRouteStepIndex:c}),o.a.createElement(v.default,Object.assign({mapStyle:"mapbox://styles/mapbox/navigation-guidance-day-v4",ref:this.mapRef},n,{onViewportChange:this.handleViewportChange}),!h&&o.a.createElement(y.a,{mapRef:this.mapRef,onViewportChange:this.handleViewportChange,onResult:this.handleSearchResult,onClear:this.handleSearchClear,mapboxApiAccessToken:"pk.eyJ1IjoiZGFucGF6IiwiYSI6ImNqMjVpYmk5czAwN2sycXBjYmd0eGNrdjkifQ.WLg6LD184VYKYQPbW7NY7w",proximity:s,position:"top-left",placeholder:"Where to?..."}),o.a.createElement(w.b,Object.assign({},n,{layers:[i,l,u]}))),e)}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[124,1,2]]]);
//# sourceMappingURL=main.43bcd733.chunk.js.map